(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0e2324"],{"7e55":function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-main",{staticClass:"grey lighten-3"},[i("v-container",[i("v-sheet",{staticClass:"white",staticStyle:{padding:"10px"}},[i("v-dialog",{attrs:{"max-width":"600px",persistent:""},model:{value:t.confirm_submit,callback:function(e){t.confirm_submit=e},expression:"confirm_submit"}},[i("v-card",[i("v-card-title",[i("span",{staticClass:"headline"},[t._v("确认提交?")])]),i("v-container",[i("v-text-field",{attrs:{label:"编辑记录: 简要描述你的编辑内容"},model:{value:t.log,callback:function(e){t.log=e},expression:"log"}})],1),i("v-card-text",[t._v(" 如果您未编辑完成, 可以点击工具栏上的保存按钮或按ctrl+s保存到本地。"),i("br"),t._v(" 请确认编辑完成后提交。 ")]),i("v-card-actions",[i("v-spacer"),i("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:t.submit}},[t._v("确认")]),i("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:function(e){t.confirm_submit=!1}}},[t._v("取消")])],1)],1)],1),i("v-container",[i("v-row",[i("v-col",{attrs:{cols:"12",sm:"4"}},[i("v-text-field",{attrs:{label:"标题"},model:{value:t.title,callback:function(e){t.title=e},expression:"title"}})],1),i("v-col",{attrs:{cols:"12",sm:"4"}},[i("v-select",{attrs:{items:t.items,label:"可见性"},model:{value:t.visibility,callback:function(e){t.visibility=e},expression:"visibility"}})],1),i("v-col",{attrs:{cols:"12",sm:"4"}},[i("v-btn",{staticClass:"ma-2",attrs:{tile:"",color:"black",dark:""},on:{click:function(e){t.confirm_submit=!0}}},[t._v("提交")]),i("v-btn",{directives:[{name:"show",rawName:"v-show",value:t.isload,expression:"isload"}],staticClass:"ma-2",attrs:{tile:"",color:"black",dark:""},on:{click:t.load}},[t._v("加载本地记录")])],1)],1),i("h6",{directives:[{name:"show",rawName:"v-show",value:!!t.msg,expression:"!!msg"}],staticStyle:{color:"grey","z-index":"2"}},[t._v(" "+t._s(t.msg)+" "),i("a",{on:{click:function(e){t.msg=""}}},[t._v("隐藏")])])],1),i("mavon-editor",{staticStyle:{"min-height":"65vh","z-index":"1"},attrs:{tabSize:4,subfield:!t.$vuetify.breakpoint.smAndDown},on:{imgAdd:t.imgAdd,save:t.save},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}})],1)],1)],1)},s=[],a=(i("96cf"),i("1da1")),o={name:"Edit",data:function(){return{article_id:"",msg:"",log:"",confirm_submit:!1,isload:!1,title:"",content:"",visibility:"正常",permission:1,items:["正常"]}},methods:{submit:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(){var e,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.confirm_submit=!1,e={log:this.log,title:this.title,content:this.content,visibility:this.permissionEnum(this.visibility)},t.next=4,this.post("article/",e);case 4:if(i=t.sent,this.app.notice(i.msg,200===i.code),401===i.code&&(this.app.login_data.show=!0),200===i.code){t.next=9;break}return t.abrupt("return");case 9:localStorage.setItem("new",""),this.$router.push("/article/"+i.article._id);case 11:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),imgAdd:function(){this.app.notice("暂不支持上传图片, 此图片将无法显示, 请使用图床",!1)},send:function(t){this.msg=t},save:function(){localStorage.setItem("new",JSON.stringify({title:this.title,content:this.content,visibility:this.visibility})),this.send("本地已保存于"+new Intl.DateTimeFormat("zh-CN",{hour:"numeric",minute:"2-digit",second:"2-digit"}).format(new Date))},load:function(){var t=JSON.parse(localStorage.getItem("new"));this.title=t.title,this.content=t.content,this.visibility=t.visibility,this.isload=!1}},created:function(){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function e(){var i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return document.title="RookieWiki - 新增",setInterval(t.save,6e4),localStorage.getItem("new")&&(t.isload=!0),e.next=5,t.get("user");case 5:i=e.sent,t.permission=i.data&&i.data.permission||1;case 7:case"end":return e.stop()}}),e)})))()},computed:{app:function(){return this.$parent.$parent}},watch:{title:function(){document.title="RookieWiki - 新增 - "+this.title}}},r=o,c=i("2877"),l=Object(c["a"])(r,n,s,!1,null,null,null);e["default"]=l.exports}}]);
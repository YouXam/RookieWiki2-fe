(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5bd64d10"],{"1dde":function(t,i,e){var r=e("d039"),s=e("b622"),n=e("2d00"),a=s("species");t.exports=function(t){return n>=51||!r((function(){var i=[],e=i.constructor={};return e[a]=function(){return{foo:1}},1!==i[t](Boolean).foo}))}},8418:function(t,i,e){"use strict";var r=e("c04e"),s=e("9bf2"),n=e("5c6c");t.exports=function(t,i,e){var a=r(i);a in t?s.f(t,a,n(0,e)):t[a]=e}},"99af":function(t,i,e){"use strict";var r=e("23e7"),s=e("d039"),n=e("e8b5"),a=e("861d"),o=e("7b0b"),c=e("50c4"),l=e("8418"),v=e("65f0"),u=e("1dde"),d=e("b622"),h=e("2d00"),m=d("isConcatSpreadable"),f=9007199254740991,p="Maximum allowed index exceeded",_=h>=51||!s((function(){var t=[];return t[m]=!1,t.concat()[0]!==t})),b=u("concat"),g=function(t){if(!a(t))return!1;var i=t[m];return void 0!==i?!!i:n(t)},y=!_||!b;r({target:"Array",proto:!0,forced:y},{concat:function(t){var i,e,r,s,n,a=o(this),u=v(a,0),d=0;for(i=-1,r=arguments.length;i<r;i++)if(n=-1===i?a:arguments[i],g(n)){if(s=c(n.length),d+s>f)throw TypeError(p);for(e=0;e<s;e++,d++)e in n&&l(u,d,n[e])}else{if(d>=f)throw TypeError(p);l(u,d++,n)}return u.length=d,u}})},e4bb:function(t,i,e){"use strict";e.r(i);var r=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("v-main",{staticClass:"grey lighten-3"},[e("v-container",[e("v-dialog",{attrs:{"max-width":"600px",persistent:""},model:{value:t.confirm_revert,callback:function(i){t.confirm_revert=i},expression:"confirm_revert"}},[e("v-card",[e("v-card-title",[e("span",{staticClass:"headline"},[t._v("确认还原?")])]),e("v-container",[e("v-text-field",{attrs:{label:"还原记录: 简要陈述你的还原理由"},model:{value:t.log,callback:function(i){t.log=i},expression:"log"}})],1),e("v-card-actions",[e("v-spacer"),e("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:t.revert}},[t._v("确认")]),e("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:function(i){t.confirm_revert=!1}}},[t._v("取消")])],1)],1)],1),e("v-dialog",{attrs:{"max-width":"600px",persistent:""},model:{value:t.change,callback:function(i){t.change=i},expression:"change"}},[e("v-card",[e("v-card-title",[e("span",{staticClass:"headline"},[t._v("修改可见性")])]),e("v-container",[e("v-select",{attrs:{items:t.items,label:"可见性"},model:{value:t.edit,callback:function(i){t.edit=i},expression:"edit"}})],1),e("v-card-actions",[e("v-spacer"),e("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:t.changev}},[t._v("确认")]),e("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:function(i){t.change=!1}}},[t._v("取消")])],1)],1)],1),e("v-sheet",{staticClass:"white elevation-2",staticStyle:{padding:"10px","min-height":"65vh"}},[t.error?e("h1",[t._v(t._s(t.msg))]):e("div",[e("h1",{staticClass:"text-center"},[t._v(t._s(t.history.log))]),e("v-btn",{staticClass:"ma-1",attrs:{plain:"",to:t.diffwithnow}},[t._v("和当前版本比较")]),t.iffirst?t._e():e("v-btn",{staticClass:"ma-1",attrs:{plain:"",to:t.diffwithpre}},[t._v("和上一版本比较")]),e("v-btn",{staticClass:"ma-1",attrs:{plain:""},on:{click:function(i){t.confirm_revert=!0}}},[t._v("还原到此版本")]),e("v-btn",{staticClass:"ma-1",attrs:{plain:""},on:{click:function(i){t.change=!0}}},[t._v("修改可见性")]),e("v-list",[e("v-list-item",[e("v-list-item-content",[e("v-list-item-title",[e("strong",[t._v("ID")])]),e("v-list-item-subtitle",[t._v(t._s(t.history._id))])],1)],1),e("v-list-item",[e("v-list-item-content",[e("v-list-item-title",[e("strong",[t._v("编号")])]),e("v-list-item-subtitle",[t._v(t._s(t.history.num))])],1)],1),e("v-list-item",[e("v-list-item-content",[e("v-list-item-title",[e("strong",[t._v("历史记录可见性")])]),e("v-list-item-subtitle",[t._v(t._s(t.visibility))])],1)],1),e("v-list-item",[e("v-list-item-content",[e("v-list-item-title",[e("strong",[t._v("编辑用户")])]),e("v-list-item-subtitle",[e("router-link",{staticClass:"link",attrs:{to:"/user/"+t.history.user}},[t._v(t._s(t.history.user))])],1)],1)],1),e("v-list-item",[e("v-list-item-content",[e("v-list-item-title",[e("strong",[t._v("编辑时间")])]),e("v-list-item-subtitle",[t._v(t._s(new Intl.DateTimeFormat("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"numeric",minute:"2-digit",second:"2-digit"}).format(new Date(t.history.date))))])],1)],1),e("v-list-item",[e("v-list-item-content",[e("v-list-item-title",[e("strong",[t._v("所属文章ID")])]),e("v-list-item-subtitle",[t._v(t._s(t.history.belong))])],1)],1),e("v-list-item",[e("v-list-item-content",[e("v-list-item-title",[e("strong",[t._v("是否修改标题")])]),e("v-list-item-subtitle",[t._v(t._s(t.history.state.title))])],1)],1),e("v-list-item",[e("v-list-item-content",[e("v-list-item-title",[e("strong",[t._v("是否修改内容")])]),e("v-list-item-subtitle",[t._v(t._s(t.history.state.content))])],1)],1),e("v-list-item",[e("v-list-item-content",[e("v-list-item-title",[e("strong",[t._v("是否修改可见性")])]),e("v-list-item-subtitle",[t._v(t._s(t.history.state.visibility))])],1)],1),e("v-list-item",[e("v-list-item-content",[e("v-list-item-title",[e("strong",[t._v("文章标题")])]),e("v-list-item-subtitle",[t._v(t._s(t.history.data.title))])],1)],1),e("v-list-item",[e("v-list-item-content",[e("v-list-item-title",[e("strong",[t._v("文章可见性")])]),e("v-list-item-subtitle",[t._v(t._s(t.history.data.visibility))])],1)],1),e("v-list-item",[e("v-list-item-content",[e("v-list-item-title",[e("strong",[t._v("文章内容")])]),e("v-container",[e("v-card",{staticStyle:{padding:"1px 20px"}},[e("Markdown",{attrs:{content:t.history.data.content}})],1)],1)],1)],1)],1)],1)])],1)],1)},s=[],n=(e("99af"),e("ac1f"),e("5319"),e("96cf"),e("1da1")),a=e("e6e0"),o={name:"History",components:{Markdown:a["a"]},data:function(){return{iffirst:!1,confirm_revert:!1,permission:1,edit:"正常",change:!1,article:{},diffwithnow:"",diffwithpre:"",article_id:"",history_id:"",error:"",visibility:"正常",history:{log:"",user:"",date:"1",data:{title:"",content:"",visibility:1},state:{}},log:""}},methods:{revert:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(){var i,e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.confirm_revert=!1,i={log:"revert from #".concat(this.history.num," - ")+this.log,title:this.history.data.title,content:this.history.data.content,visibility:this.history.data.visibility},t.next=4,this.post("article/"+this.article_id,i);case 4:if(e=t.sent,this.app.notice(e.msg,200===e.code),423!==e.code){t.next=8;break}return t.abrupt("return",this.$router.push("/user/"+this.app.username));case 8:this.$router.push("/article/"+this.article_id);case 9:case"end":return t.stop()}}),t,this)})));function i(){return t.apply(this,arguments)}return i}(),changev:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(){var i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.change=!1,t.next=3,this.post("article/"+this.article_id+"/history/"+this.history_id,{visibility:{"正常":1,"隐藏":2}[this.edit]});case 3:if(i=t.sent,this.app.notice(i.msg,200===i.code),423!==i.code){t.next=7;break}return t.abrupt("return",this.$router.push("/user/"+this.app.username));case 7:this.update();case 8:case"end":return t.stop()}}),t,this)})));function i(){return t.apply(this,arguments)}return i}(),update:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(){var i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.get("article/"+this.article_id+"/history/"+this.history_id);case 2:if(i=t.sent,200!==i.code){t.next=13;break}document.title="RookieWiki - 历史记录 - "+this.article.title+" - "+i.data.log,this.diffwithnow="/article/".concat(this.article_id,"/diff?aid=").concat(i.data.num,"&bid=").concat(this.article.history_total),this.diffwithpre="/article/".concat(this.article_id,"/diff?aid=").concat(i.data.num-1,"&bid=").concat(i.data.num),this.iffirst=1===i.data.num,this.history=i.data,this.length=parseInt((i.total-1)/(i.size||20))+1,this.edit=this.visibility={1:"正常",2:"隐藏"}[i.data.history_visibility],t.next=19;break;case 13:if(404!==i.code){t.next=17;break}return t.abrupt("return",this.$router.replace("/404"));case 17:this.error=!0,this.msg=i.code+" "+i.msg;case 19:case"end":return t.stop()}}),t,this)})));function i(){return t.apply(this,arguments)}return i}()},created:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function i(){var e,r;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return t.article_id=t.$route.params.article_id,t.history_id=t.$route.params.history_id,i.next=4,t.get("article/"+t.article_id);case 4:if(e=i.sent,200===e.code){i.next=9;break}return t.error=!0,t.msg=e.code+" "+e.msg,i.abrupt("return");case 9:return t.article=e.article,t.update(),i.next=13,t.get("user");case 13:r=i.sent,200===r.code&&(t.permission=r.data.permission);case 15:case"end":return i.stop()}}),i)})))()},computed:{items:function(){var t=["正常"];return this.permission>1&&t.push("隐藏"),t},app:function(){return this.$parent.$parent}}},c=o,l=e("2877"),v=Object(l["a"])(c,r,s,!1,null,null,null);i["default"]=v.exports}}]);